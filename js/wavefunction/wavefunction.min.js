function calcWfn(r,e,a,_,n,s,o){for(var f=Math.sqrt(r*r+e*e+a*a),t=Math.atan(e,r),i=1,v=0;v<2*n+1;v++)i/=_-n+v;i=Math.sqrt(i=4*i/_**4),i*=Math.exp(-f/_)*Math.pow(2*f/_,n)*LaguerreL(_-n-1,2*n+1,2*f/_);for(var u=1,v=1;v<2*Math.abs(s);v++)u/=n-Math.abs(s)+v;if(u=Math.sqrt(u=u*(2*n+1)/(4*Math.PI))*Associated_Legendre(n,Math.abs(s),a/f),o){if(s<0||s%2==0)var c=Math.cos(s*t);else var c=-Math.cos(s*t)}else if(s<0||s%2==0)var c=Math.sin(s*t);else var c=-Math.sin(s*t);return i*u*c}function LaguerreL(r,e,a){for(var _,n=0,s=1,o=1;o<=r;o++)_=n,s=((2*o-1+e-a)*(n=s)-(o-1+e)*_)/o;return s}function Associated_Legendre(r,e,a){for(var _=1,n=1;n<2*e-1;n+=2)_*=n;var s=Math.pow(-1,e%2)*_*Math.pow(1-a**2,e/2);if(r==e)return s;var o=a*(2*e+1)*s;if(r==e+1)return o;for(var f=e+2;f<=r;f++)L3=(a*(2*f-1)*o-(f+e-1)*s)/(f-e),s=o,o=L3;return L3}