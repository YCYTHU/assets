function initializeCanvas(e,t){let n=e.getContext("2d");return e.style.backgroundColor="#000",e.width=window.innerWidth*t,e.height=window.innerHeight*t,e.style.width=`${window.innerWidth}px`,e.style.height=`${window.innerHeight}px`,n.translate(0,e.height),n.scale(t,-t),n}function calculateColorLim(e,t=1e3){let n=-1/0,i=1/0;for(let o=0;o<t;o++){let r=Math.random()*bounds.width,l=Math.random()*bounds.height,[,,,a]=e.interpolate(r,l);a>n&&(n=a),a<i&&(i=a)}return i===n&&(n+=1,i-=1),[i,n]}function calculateColorScale(e,t,n){function i(e,t,n){return e.map((e,i)=>Math.round(e+n*(t[i]-e)))}let o=[];for(let r=0;r<=e;r++){let l=r/e,a=l*(n.length-1),h=Math.floor(a),g=a-h,d=h<n.length-1?i(n[h],n[h+1],g):n[n.length-1];o.push(`rgba(${d[0]}, ${d[1]}, ${d[2]}, 0.8)`)}return{indexFor:n=>Math.max(Math.min(Math.floor((n-t[0])/(t[1]-t[0])*e),e),0),getColor:e=>o[e]}}function randomizeParticle(e){return e.x=Math.random()*bounds.width,e.y=Math.random()*bounds.height,e.age=Math.random()*MAX_PARTICLE_AGE,e}function evolve(e,t){e.forEach(e=>{e.age>MAX_PARTICLE_AGE&&randomizeParticle(e);let n=t.interpolate(e.x,e.y),i=n[2];n&&null!==i?(e.x+=EVOLVE_STEP*n[0],e.y+=EVOLVE_STEP*n[1],(e.x>bounds.width||e.x<0||e.y>bounds.height||e.y<0)&&randomizeParticle(e)):e.age=MAX_PARTICLE_AGE,e.age++})}function draw(e,t,n,i){i.globalCompositeOperation="destination-in",i.fillStyle="rgba(0, 0, 0, 0.95)",i.fillRect(bounds.x,bounds.y,bounds.width,bounds.height),i.globalCompositeOperation="lighter",i.lineWidth=LINE_WIDTH,e.forEach(e=>{let o=t.interpolate(e.x,e.y),r=o[2],l=o[0]/r,a=o[1]/r,h=n.indexFor(o[3]);i.strokeStyle=n.getColor(h),i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(e.x-l,e.y-a),i.stroke()})}function frame(e,t,n,i){evolve(e,t),draw(e,t,n,i),setTimeout(()=>requestAnimationFrame(()=>frame(e,t,n,i)),FRAME_RATE)}